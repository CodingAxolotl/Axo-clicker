<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Axolotl Clicker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cloud.umami.is/script.js" data-website-id="d8c86780-e5be-41e5-a6dc-f84ceed23250"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }

    /* New CSS for the floating click points animation */
    .click-point {
        position: absolute;
        font-size: 1.5rem;
        font-weight: bold;
        color: #fff;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        opacity: 1;
        animation: floatAndFade 1s forwards;
        pointer-events: none; /* Prevent clicks on the text itself */
        user-select: none; /* Prevent text selection */
    }

    @keyframes floatAndFade {
        0% {
            transform: translateY(0);
            opacity: 1;
        }
        100% {
            transform: translateY(-50px);
            opacity: 0;
        }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-pink-300 via-purple-400 to-indigo-500 min-h-screen flex items-center justify-center p-4 text-gray-800">

  <div id="messageModal" class="fixed inset-0 z-50 hidden bg-gray-900 bg-opacity-75 flex items-center justify-center transition-opacity duration-300">
    <div class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm m-4 transform transition-transform duration-300 scale-95 hover:scale-100">
      <div class="flex justify-between items-center mb-4">
        <h3 id="messageTitle" class="text-xl font-bold text-pink-600"></h3>
        <button id="modalCloseButton" class="text-gray-400 hover:text-gray-600">×</button>
      </div>
      <p id="messageBody" class="text-gray-700"></p>
    </div>
  </div>

  <div id="permissionModal" class="fixed inset-0 z-50 bg-gray-900 bg-opacity-75 flex items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm m-4 text-center">
      <h3 class="text-xl font-bold text-purple-600 mb-4">Save Progress?</h3>
      <p class="text-gray-700 mb-6">Do you want to save your game progress in your browser? This will allow you to continue where you left off.</p>
      <div class="flex justify-center gap-4">
        <button id="permissionYes" class="bg-green-500 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-green-600 transition-colors">Yes</button>
        <button id="permissionNo" class="bg-red-500 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-red-600 transition-colors">No</button>
      </div>
    </div>
  </div>

  <div id="gameContent" class="hidden flex flex-col lg:flex-row items-center justify-center gap-8 w-full max-w-6xl">
    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md text-center border-4 border-purple-300">
      <h1 class="text-5xl font-extrabold text-pink-600 mb-4 drop-shadow-md">Axolotl Clicker</h1>

      <div id="status" class="space-y-1 mb-6">
        <p class="text-2xl font-semibold">Points: <span id="points" class="font-mono">0</span></p>
        <p class="text-lg">Points per click: <span id="pointsPerClick">1</span></p>
        <p class="text-lg">CPS: <span id="cps">0</span></p>
        <p class="text-lg">Auto Point Giver Level: <span id="autoPointLevel">0</span></p>
        <p class="text-lg">Total Clicks: <span id="clicks">0</span></p>
      </div>

      <!-- The SVG has been replaced with an image tag -->
      <div id="clickButton" class="w-48 h-48 mx-auto mb-6 cursor-pointer relative">
        <img src="axolotl.WEBP" alt="A cute axolotl to click" class="w-full h-full object-contain transition-transform duration-200 hover:scale-105">
      </div>

      <div class="flex flex-col space-y-4">
        <button id="upgradeButton" class="bg-purple-400 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform">
          Upgrade Click to Level 1 — Cost: <span id="upgradeCost">50</span>
        </button>
        <button id="autoUpgradeOneButton" class="bg-cyan-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform">
          Buy 1 Auto Point Giver — Cost: 500,000
        </button>
        <button id="autoUpgradeTenButton" class="bg-cyan-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform">
          Buy 10 Auto Point Givers — Cost: 4,750,000
        </button>
        <button id="doubleBoostButton" class="bg-yellow-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform">
          ⚡ Double Points (15s) — Cost: 20,000
        </button>
        <button id="saveProgressButton" class="hidden bg-gray-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform hover:scale-105 transition-transform">
          Save Progress
        </button>
        <a href="https://www.youtube.com/watch?v=WO_z3jteozU" target="_blank" class="block">
          <button class="bg-purple-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg w-full transform hover:scale-105 transition-transform">
            Watch the Tutorial!
          </button>
        </a>
      </div>
      <button id="deleteProgressButton" class="mt-6 bg-red-500 text-white font-bold py-2 px-6 rounded-xl shadow-lg w-full transform hover:scale-105 transition-transform">
        Delete All Progress
      </button>
    </div>

    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-sm text-center border-4 border-pink-300">
      <h2 class="text-3xl font-bold text-purple-600 mb-4">Axolotl Skins</h2>
      <!-- The skin display is no longer needed since we are using a single static image -->
      <div id="skinDisplay" class="mb-4 hidden"></div>
      <!-- Skins are now disabled -->
      <div id="skinButtons" class="flex flex-wrap justify-center gap-2 mb-4"></div>
      <p class="text-sm text-gray-500">Each skin costs 10,000 points.</p>
    </div>
  </div>

  <script>
    // The key for auto-clicker warnings
    const autoClickerWarningsKey = 'axolotlClickerWarnings';
    // Failsafe check to prevent loading a game after auto-clicker punishment.
    const warningsOnLoad = parseInt(localStorage.getItem(autoClickerWarningsKey) || '0', 10);
    if (warningsOnLoad >= 2) {
        localStorage.removeItem('axolotlClickerSave');
        localStorage.removeItem('axolotlClickerPermission');
        localStorage.removeItem(autoClickerWarningsKey);
        window.location.reload();
    }

    // Game state variables
    let points = 0;
    let pointsPerClick = 1;
    let clickUpgradeLevel = 0;
    let clickUpgradeCost = 50;
    let autoPointLevel = 0;
    let bonusMultiplierActive = false;
    let clicks = 0;
    let currentSkin = 0;
    let ownedSkins = [0];
    let canUseLocalStorage = false;
    let autoClickerWarnings = parseInt(localStorage.getItem(autoClickerWarningsKey) || '0', 10);

    // CPS related variables
    let clicksThisSecond = 0;
    let cps = 0;

    // Define skin colors for the axolotl
    const skinColors = ['#FF69B4', '#9932CC', '#FFFF00', '#00FF00', '#00BFFF', '#FFD700', '#FF4500'];

    // UI elements
    const pointsEl = document.getElementById('points');
    const pointsPerClickEl = document.getElementById('pointsPerClick');
    const upgradeCostEl = document.getElementById('upgradeCost');
    const cpsEl = document.getElementById('cps'); // New CPS element
    const autoPointLevelEl = document.getElementById('autoPointLevel');
    const clicksEl = document.getElementById('clicks');
    const clickButton = document.getElementById('clickButton');
    const upgradeButton = document.getElementById('upgradeButton');
    const autoUpgradeOneButton = document.getElementById('autoUpgradeOneButton');
    const autoUpgradeTenButton = document.getElementById('autoUpgradeTenButton');
    const doubleBoostButton = document.getElementById('doubleBoostButton');
    const saveProgressButton = document.getElementById('saveProgressButton');
    const skinButtonsContainer = document.getElementById('skinButtons');
    const gameContent = document.getElementById('gameContent');
    const messageModal = document.getElementById('messageModal');
    const messageTitleEl = document.getElementById('messageTitle');
    const messageBodyEl = document.getElementById('messageBody');
    const modalCloseButton = document.getElementById('modalCloseButton');
    const permissionModal = document.getElementById('permissionModal');
    const permissionYesBtn = document.getElementById('permissionYes');
    const permissionNoBtn = document.getElementById('permissionNo');
    const deleteProgressButton = document.getElementById('deleteProgressButton');
    const axolotlImage = document.querySelector('#clickButton img');

    // Function to show the custom modal
    function showModal(title, body) {
        messageTitleEl.textContent = title;
        messageBodyEl.innerHTML = body;
        messageModal.classList.remove('hidden');
    }

    // Function to hide the custom modal
    modalCloseButton.addEventListener('click', () => {
        messageModal.classList.add('hidden');
    });

    // Function to update the UI with current game state
    function updateDisplay() {
      pointsEl.textContent = points.toLocaleString();
      pointsPerClickEl.textContent = pointsPerClick.toLocaleString();
      upgradeCostEl.textContent = clickUpgradeCost.toLocaleString();
      cpsEl.textContent = cps.toLocaleString(); // Update CPS display
      autoPointLevelEl.textContent = autoPointLevel.toLocaleString();
      clicksEl.textContent = clicks.toLocaleString();
      upgradeButton.innerHTML = `Upgrade Click to Level ${clickUpgradeLevel + 1} — Cost: <span id="upgradeCost">${clickUpgradeCost.toLocaleString()}</span>`;

      // Visual feedback for double boost
      if (bonusMultiplierActive) {
        doubleBoostButton.classList.add('animate-pulse', 'bg-yellow-400');
        doubleBoostButton.classList.remove('bg-yellow-500');
      } else {
        doubleBoostButton.classList.remove('animate-pulse', 'bg-yellow-400');
        doubleBoostButton.classList.add('bg-yellow-500');
      }

      // We no longer need to update the axolotl skin SVG, but we still update the skin buttons
      updateSkinButtons();
    }

    // Function to update the skin selection buttons (now disabled)
    function updateSkinButtons() {
      skinButtonsContainer.innerHTML = '';
      skinColors.forEach((color, i) => {
        const btn = document.createElement('div');
        btn.classList.add('w-10', 'h-10', 'rounded-lg', 'border-4', 'transition-all', 'duration-200');
        btn.style.backgroundColor = color;
        // The skins are now disabled, so we only need to show which ones are owned.
        if (ownedSkins.includes(i)) {
          btn.title = 'Owned Skin (Disabled)';
          btn.classList.add('border-gray-400', 'cursor-not-allowed');
        } else {
          btn.title = 'Buy for 10,000 points (Disabled)';
          btn.classList.add('border-gray-300', 'cursor-not-allowed', 'opacity-50');
        }
        if (i === currentSkin) {
          // The current skin is still highlighted with a pink border
          btn.classList.remove('border-gray-300', 'border-gray-400');
          btn.classList.add('border-pink-500', 'scale-110');
        }
        skinButtonsContainer.appendChild(btn);
      });
    }

    // Function to save the game state to Local Storage
    function saveGameState() {
        if (!canUseLocalStorage) return;
        const saveData = {
            points, pointsPerClick, clickUpgradeLevel, clickUpgradeCost,
            autoPointLevel, bonusMultiplierActive, clicks, currentSkin, ownedSkins
        };
        try {
            localStorage.setItem('axolotlClickerSave', JSON.stringify(saveData));
            showModal('Game Saved!', 'Your progress has been saved.');
        } catch (e) {
            console.error("Error saving to local storage:", e);
        }
    }

    // Function to load the game state from Local Storage
    function loadGameState() {
        if (!canUseLocalStorage) return;
        try {
            const savedData = JSON.parse(localStorage.getItem('axolotlClickerSave'));
            if (savedData) {
                points = savedData.points || 0;
                pointsPerClick = savedData.pointsPerClick || 1;
                clickUpgradeLevel = savedData.clickUpgradeLevel || 0;
                clickUpgradeCost = savedData.clickUpgradeCost || 50;
                autoPointLevel = savedData.autoPointLevel || 0;
                bonusMultiplierActive = savedData.bonusMultiplierActive || false;
                clicks = savedData.clicks || 0;
                currentSkin = savedData.currentSkin || 0;
                ownedSkins = Array.isArray(savedData.ownedSkins) ? savedData.ownedSkins : [0];
                showModal('Game Loaded!', 'Your game progress has been loaded from your browser.');
            } else {
                showModal('New Game Started', 'Welcome! Your progress will be saved automatically.');
            }
        } catch (e) {
            console.error("Error loading from local storage:", e);
            showModal('Loading Error', 'Failed to load saved game data. Starting a new game.');
        }
    }

    // Reset game state to defaults
    function resetGameState() {
        points = 0;
        pointsPerClick = 1;
        clickUpgradeLevel = 0;
        clickUpgradeCost = 50;
        autoPointLevel = 0;
        bonusMultiplierActive = false;
        clicks = 0;
        currentSkin = 0;
        ownedSkins = [0];
        autoClickerWarnings = 0;
        updateDisplay();
    }
    
    // Function to create and animate the floating point text
    function createClickPoint(e) {
        const clickPoint = document.createElement('div');
        clickPoint.textContent = `+${pointsPerClick}`;
        clickPoint.classList.add('click-point');

        // Set position relative to the viewport
        clickPoint.style.left = `${e.clientX}px`;
        clickPoint.style.top = `${e.clientY}px`;
        
        document.body.appendChild(clickPoint);

        // Remove the element after the animation is done
        setTimeout(() => {
            clickPoint.remove();
        }, 1000); // Matches the animation duration
    }

    // Event listeners
    axolotlImage.addEventListener('click', (e) => {
      let gain = pointsPerClick;
      if (bonusMultiplierActive) gain *= 2;
      points += gain;
      clicks++;
      clicksThisSecond++; // Increment the clicks for CPS calculation
      updateDisplay();
      createClickPoint(e); // Call the new function to show the floating points
    });
    
    upgradeButton.addEventListener('click', () => {
      if (points >= clickUpgradeCost) {
        points -= clickUpgradeCost;
        clickUpgradeLevel++;
        pointsPerClick++;
        clickUpgradeCost = Math.floor(clickUpgradeCost * 1.2);
        updateDisplay();
      } else {
        showModal('Not enough points!', 'You need more points to upgrade your click.');
      }
    });

    autoUpgradeOneButton.addEventListener('click', () => {
      const cost = 500000;
      if (autoPointLevel >= 500) {
        showModal('Max Level Reached', 'The maximum Auto Point Giver level is 500!');
        return;
      }
      if (points >= cost) {
        points -= cost;
        autoPointLevel++;
        updateDisplay();
      } else {
        showModal('Not enough points!', `You need ${cost.toLocaleString()} points.`);
      }
    });

    autoUpgradeTenButton.addEventListener('click', () => {
      const canBuy = Math.min(10, 500 - autoPointLevel);
      const cost = 4750000;
      if (canBuy > 0 && points >= cost) {
        points -= cost;
        autoPointLevel += canBuy;
        updateDisplay();
      } else if (autoPointLevel >= 500) {
        showModal('Max Level Reached', 'The maximum Auto Point Giver level is 500!');
      } else {
        showModal('Not enough points!', `You need ${cost.toLocaleString()} points.`);
      }
    });

    doubleBoostButton.addEventListener('click', () => {
      const cost = 20000;
      if (points >= cost && !bonusMultiplierActive) {
        points -= cost;
        bonusMultiplierActive = true;
        showModal('Double Points!', 'You are now getting double points for 15 seconds!');
        updateDisplay();
        setTimeout(() => {
          bonusMultiplierActive = false;
          showModal('Boost Expired', 'The double points boost has ended.');
          updateDisplay();
        }, 15000);
      } else if (bonusMultiplierActive) {
        showModal('Boost Active', 'The double points boost is already active.');
      } else {
        showModal('Not enough points!', `You need ${cost.toLocaleString()} points.`);
      }
    });

    saveProgressButton.addEventListener('click', () => {
        saveGameState();
    });
    
    deleteProgressButton.addEventListener('click', () => {
        showModal(
            'Confirm Deletion',
            `<p class="mb-4">Are you sure you want to delete all your game progress? This action cannot be undone.</p>
            <div class="flex justify-center gap-4">
                <button id="confirmDeleteYes" class="bg-red-500 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-red-600 transition-colors">Yes, Delete</button>
                <button id="confirmDeleteNo" class="bg-gray-400 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-gray-500 transition-colors">No, Cancel</button>
            </div>`
        );
        document.getElementById('confirmDeleteYes').addEventListener('click', () => {
            localStorage.removeItem('axolotlClickerSave');
            messageModal.classList.add('hidden');
            resetGameState();
            showModal('Progress Deleted', 'Your game progress has been deleted. Starting a new game.');
        });
        document.getElementById('confirmDeleteNo').addEventListener('click', () => {
            messageModal.classList.add('hidden');
        });
    });

    // Auto-point generation every second
    setInterval(() => {
        if (autoPointLevel > 500) autoPointLevel = 500;
        points += autoPointLevel;
        updateDisplay();
    }, 1000);

    // CPS calculation and auto-clicker detection every second
    setInterval(() => {
        cps = clicksThisSecond;
        clicksThisSecond = 0; // Reset counter for the next second
        updateDisplay();

        if (cps > 20) {
            autoClickerWarnings++;
            localStorage.setItem(autoClickerWarningsKey, autoClickerWarnings); // Save the warning count to a separate key
            
            if (autoClickerWarnings >= 2) {
                // Second offense: delete all progress and reload
                localStorage.removeItem('axolotlClickerSave');
                localStorage.removeItem('axolotlClickerPermission');
                localStorage.removeItem(autoClickerWarningsKey);
                window.location.reload();
            } else {
                // First offense: show warning
                showModal(
                    'Auto Clicker Detected!',
                    "Don't use an auto clicker! (If you use it again your progress will be deleted (over 20 CPS))"
                );
            }
        }
    }, 1000);

    // Initial game setup and local storage permission
    window.addEventListener('DOMContentLoaded', () => {
        const hasPermission = localStorage.getItem('axolotlClickerPermission');
        if (hasPermission === 'true') {
            canUseLocalStorage = true;
            permissionModal.classList.add('hidden');
            saveProgressButton.classList.remove('hidden'); // Show save button
            const savedData = localStorage.getItem('axolotlClickerSave');
            if (savedData) {
                loadGameState();
            } else {
                showModal('New Game Started', 'Welcome! Your progress will be saved automatically.');
            }
            gameContent.classList.remove('hidden');
            updateDisplay();
        } else if (hasPermission === 'false') {
            canUseLocalStorage = false;
            permissionModal.classList.add('hidden');
            saveProgressButton.classList.add('hidden'); // Hide save button
            gameContent.classList.remove('hidden');
            updateDisplay();
        } else {
            // Show permission modal for the first time
            permissionModal.classList.remove('hidden');
        }
    });

    permissionYesBtn.addEventListener('click', () => {
        canUseLocalStorage = true;
        localStorage.setItem('axolotlClickerPermission', 'true');
        permissionModal.classList.add('hidden');
        saveProgressButton.classList.remove('hidden'); // Show save button
        const savedData = localStorage.getItem('axolotlClickerSave');
        if (savedData) {
            loadGameState();
        } else {
            showModal('New Game Started', 'Welcome! Your progress can now be saved.');
        }
        gameContent.classList.remove('hidden');
        updateDisplay();
    });

    permissionNoBtn.addEventListener('click', () => {
        canUseLocalStorage = false;
        localStorage.setItem('axolotlClickerPermission', 'false');
        permissionModal.classList.add('hidden');
        saveProgressButton.classList.add('hidden'); // Hide save button
        gameContent.classList.remove('hidden');
        updateDisplay();
        showModal('Progress Not Saved', 'Your progress will not be saved. Please click "Yes" to save data on your next visit.');
    });
  </script>
</body>
</html>
